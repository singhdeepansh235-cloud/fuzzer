import React from 'react';
import { Vulnerability, Severity } from '../types';
import { Shield, ExternalLink, Bot } from 'lucide-react';

interface VulnerabilityListProps {
  vulns: Vulnerability[];
  onAnalyze: (vuln: Vulnerability) => void;
}

const VulnerabilityList: React.FC<VulnerabilityListProps> = ({ vulns, onAnalyze }) => {
  const getSeverityColor = (sev: Severity) => {
    switch (sev) {
      case Severity.CRITICAL: return 'text-red-500 bg-red-500/10 border-red-500/20';
      case Severity.HIGH: return 'text-orange-500 bg-orange-500/10 border-orange-500/20';
      case Severity.MEDIUM: return 'text-yellow-500 bg-yellow-500/10 border-yellow-500/20';
      case Severity.LOW: return 'text-blue-500 bg-blue-500/10 border-blue-500/20';
      default: return 'text-zinc-400 bg-zinc-800 border-zinc-700';
    }
  };

  return (
    <div className="space-y-4">
      {vulns.length === 0 ? (
         <div className="text-center py-12 bg-surface rounded-xl border border-dashed border-zinc-800">
           <Shield className="w-12 h-12 text-zinc-700 mx-auto mb-3" />
           <h3 className="text-zinc-400 font-medium">No vulnerabilities detected yet</h3>
           <p className="text-sm text-zinc-600 mt-1">Start a scan to populate this list</p>
         </div>
      ) : (
        vulns.map((vuln) => (
          <div key={vuln.id} className="bg-surface rounded-xl p-4 border border-zinc-800 hover:border-zinc-700 transition-colors flex flex-col md:flex-row gap-4 items-start md:items-center justify-between">
            <div className="flex items-start gap-4">
              <div className={`px-3 py-1 rounded text-xs font-bold border uppercase tracking-wider ${getSeverityColor(vuln.severity)}`}>
                {vuln.severity}
              </div>
              <div>
                <h4 className="font-semibold text-white text-lg">{vuln.title}</h4>
                <div className="flex flex-col sm:flex-row gap-2 sm:gap-4 mt-1 text-sm text-zinc-400">
                  <span className="font-mono bg-black/30 px-2 py-0.5 rounded text-zinc-500">{vuln.endpoint}</span>
                  <span className="hidden sm:block text-zinc-600">â€¢</span>
                  <span className="truncate max-w-[200px] italic opacity-70">Payload: {vuln.payload}</span>
                </div>
              </div>
            </div>
            
            <div className="flex gap-2 w-full md:w-auto">
              <button 
                onClick={() => onAnalyze(vuln)}
                className="flex-1 md:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-primary/10 hover:bg-primary/20 text-primary text-sm font-medium rounded-lg transition-colors border border-primary/20"
              >
                <Bot className="w-4 h-4" />
                AI Remediation
              </button>
            </div>
          </div>
        ))
      )}
    </div>
  );
};

export default VulnerabilityList;